# ميزة البحث النصي عن الموقع - دليل الاستخدام

## ✅ تم التنفيذ بنجاح!

تم إضافة ميزة البحث النصي عن الموقع مع اقتراحات Google Places إلى تطبيق غسيل السيارات.

## الملفات المحدثة:

### 1. ملف البيئة (`test_local.env`)
```env
GOOGLE_PLACES_API_KEY=AIzaSyCwdrmyLmP3mam7P4bH-1QVHAKdikHxDDQ
```

### 2. ملف التبعيات (`pubspec.yaml`)
- تم إزالة المكتبة الخارجية واستخدام حل مخصص
- استخدام HTTP requests مباشرة لـ Google Places API

### 3. الشاشة الجديدة (`map_picker_with_search_screen.dart`)
- شاشة جديدة مع ميزة البحث النصي
- واجهة مستخدم محسنة مع قائمة منسدلة للبحث
- دعم البحث باللغة العربية والإنجليزية
- تحديد جغرافي لدول الخليج العربي

### 4. الشاشات المحدثة:
- `single_wash_order_screen.dart`
- `order_request_screen.dart` 
- `multi_car_order_screen.dart`

## الميزات الجديدة:

### 🔍 البحث النصي
- اكتب اسم المكان أو العنوان
- احصل على اقتراحات فورية من Google Places
- دعم البحث باللغة العربية والإنجليزية

### 🗺️ الخريطة التفاعلية
- حرك الخريطة لتحديد الموقع يدوياً
- مؤشر أحمر يوضح الموقع المحدد
- تحديث العنوان تلقائياً عند تحريك الخريطة

### 📍 الموقع الحالي
- زر للانتقال إلى الموقع الحالي
- طلب أذونات الموقع تلقائياً

### 🌍 تحديد جغرافي
- البحث محدود بدول الخليج العربي:
  - الإمارات العربية المتحدة
  - المملكة العربية السعودية
  - الكويت
  - قطر
  - البحرين
  - عمان

## كيفية الاستخدام:

### للمستخدم:
1. اضغط على أيقونة البحث في أعلى الشاشة
2. اكتب اسم المكان أو العنوان
3. اختر من القائمة المقترحة
4. أو حرك الخريطة لتحديد الموقع يدوياً
5. اضغط "تأكيد الموقع" لحفظ الاختيار

### للمطور:
```dart
// استخدام الشاشة الجديدة
final picked = await Navigator.push(
  context,
  MaterialPageRoute(
    builder: (context) => MapPickerWithSearchScreen(
      initialLocation: LatLng(latitude, longitude),
    ),
  ),
);

if (picked != null) {
  final latlng = picked['latlng'] as LatLng;
  final address = picked['address'] as String;
  // استخدم البيانات هنا
}
```

## المتطلبات التقنية:

### Google Places API:
- ✅ API Key موجود: `AIzaSyCwdrmyLmP3mam7P4bH-1QVHAKdikHxDDQ`
- ⚠️ تأكد من تفعيل Places API في Google Cloud Console
- ⚠️ تأكد من تفعيل الفوترة (حتى لو كانت مجانية)

### الأذونات المطلوبة:
- `ACCESS_FINE_LOCATION` - للموقع الدقيق
- `ACCESS_COARSE_LOCATION` - للموقع التقريبي
- `INTERNET` - للوصول إلى Google APIs

## اختبار الميزة:

### 1. تشغيل التطبيق:
```bash
cd c:\car_wash_app
flutter pub get
flutter run
```

### 2. اختبار البحث:
- اذهب إلى أي شاشة طلب خدمة
- اضغط على اختيار الموقع
- جرب البحث بـ:
  - "دبي مول"
  - "برج خليفة"
  - "مطار دبي"
  - "شارع الشيخ زايد"

### 3. اختبار الخريطة:
- حرك الخريطة يدوياً
- اضغط زر الموقع الحالي
- تأكد من تحديث العنوان تلقائياً

## استكشاف الأخطاء:

### إذا لم تظهر نتائج البحث:
1. تأكد من تفعيل Places API في Google Cloud Console
2. تأكد من صحة API Key
3. تأكد من تفعيل الفوترة

### إذا لم يعمل الموقع الحالي:
1. تأكد من منح أذونات الموقع للتطبيق
2. تأكد من تفعيل GPS في الجهاز

### إذا لم تظهر الخريطة:
1. تأكد من إضافة API Key في AndroidManifest.xml
2. تأكد من إضافة API Key في AppDelegate.swift

## ملاحظات مهمة:

- الميزة تعمل مع نفس API Key المستخدم للخرائط
- لا حاجة لتعديل Laravel API
- البحث محدود بدول الخليج العربي لتحسين الأداء
- يتم حفظ العنوان والإحداثيات في قاعدة البيانات

## الدعم:

إذا واجهت أي مشاكل، تأكد من:
1. صحة API Key
2. تفعيل Places API
3. اتصال الإنترنت
4. أذونات الموقع

---
**تم التنفيذ بنجاح! 🎉**
